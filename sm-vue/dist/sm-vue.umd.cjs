(function(t,l){typeof exports=="object"&&typeof module<"u"?module.exports=l(require("vue")):typeof define=="function"&&define.amd?define(["vue"],l):(t=typeof globalThis<"u"?globalThis:t||self,t["sm-vue"]=l(t.Vue))})(this,function(t){"use strict";const l={default:{_packs:{missile:5,"super-missile":5,"power-bomb":5}},nature:{_packs:{missile:5,"super-missile":3,"power-bomb":2},"x-ray":"beam-burst"},vitality:{_packs:{missile:2,"super-missile":1,"power-bomb":1}},ascent:{"spring-ball":"boost-ball",draygon:"weapons-tank","x-ray":"shinespark"}},k=(e,s)=>{const r=e.__vccOpts||e;for(const[o,a]of s)r[o]=a;return r},$=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\s_]+/g,"-").toLowerCase(),h=[["energy-tank","reserve-tank","missile","super-missile","power-bomb"],["charge-beam","ice-beam","wave-beam","spazer-beam","plasma-beam"],["morph-ball","varia-suit","spring-ball","hi-jump-boots","space-jump"],["bomb","gravity-suit","ridley","speed-booster","screw-attack"],["grappling-beam","kraid","phantoon","draygon","x-ray"]],u=[["cwisp","morph-ball","bomb","spring-ball"],["hi-jump-boots","speed-booster","space-jump","screw-attack"],["varia-suit","ridley","gravity-suit"],["kraid","phantoon","draygon"]],j=[["cwisp","morph-ball","bomb","spring-ball","varia-suit"],["hi-jump-boots","speed-booster","space-jump","screw-attack","gravity-suit"]],v=h[0],x=(e,s)=>!e||typeof e!="number"?null:(s?e*s:e).toString().padStart(2,0).split("").map(o=>`smi-number -number-${o}`),E=(e,s)=>["ridley","draygon","phantoon","kraid"].includes(e)?[`sm-g4-head -${e}`,s&&"-inactive"]:[`sm-item -${e}`,!s&&"-has-not"],b={"kill kraid":!0,"kill phantoon":!0,"kill draygon":!0,"kill ridley":!0,kraid:!0,phantoon:!0,draygon:!0,ridley:!0},C=e=>e.map(s=>s.filter(r=>!b[r])),S={props:{inventory:Object,controlled:Boolean,mode:String,rows:Array,world:String,objectives:Object},emits:["add-item","toggle-item","toggle-objective"],computed:{vanilla_objectives(){return!Object.keys(this.objectives||{}).find(s=>!b[s])},row_slugs(){if(this.rows)return this.rows;let e=h.map(r=>r.slice());const s=l[this.world];return this.mode==="cwisp"?this.vanilla_objectives?e=u.map(r=>r.slice()):Object.keys(this.objectives||{}).length<=6?e=u:e=j.map(r=>r.slice()):this.mode==="compact"&&(e[4].pop(),e[4].shift(),e.shift()),s&&(e=e.map(r=>r.map(o=>s[o]||o))),this.vanilla_objectives||(e=C(e)),e},prepped_rows(){var r;const e=l[this.world]||l.default,s=this.row_slugs.map(o=>o.map(a=>{var i;const c=this.inventory[a];return{slug:a,numbers:x(c,(i=e._packs)==null?void 0:i[a]),attrs:{class:[E(a,c),c>99&&"-three-digits"],id:`grid-tracker__${a}`}}}));if(!this.vanilla_objectives){const o=Object.keys(this.objectives||{}),a=o.length>15?6:s[0].length;this.mode||s[3].push(...s.pop());let c=s.findIndex(i=>i.length<s[0].length);for(c===-1&&(c=s.length);o.length>0;){for(;((r=s[c])==null?void 0:r.length)>=a;)c++;s[c]||s.push([]);const i=o.shift(),m=$(i);s[c].push({slug:i,type:"objective",attrs:{class:`smv-objective -${m} -${this.objectives[i]?"in":""}active`,id:`grid-tracker__${m}`}})}}return s}},methods:{click(e,{slug:s,type:r}={}){if(r==="objective")this.$emit("toggle-objective",s);else if(v.includes(s)){const o=e.shiftKey||e.ctrlKey?-1:1;this.$emit("add-item",s,o)}else this.$emit("toggle-item",s)}}},I=["onClick"],T={key:0,class:"grid-tracker__numbers"};function z(e,s,r,o,a,c){const i=t.resolveComponent("sm-cwisp-tracker");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(`grid-tracker smi-tracker ${r.controlled?"-controlled":""}`)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.prepped_rows,(m,g)=>(t.openBlock(),t.createElementBlock("div",{key:g,class:"grid-tracker__row"},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(m,p=>(t.openBlock(),t.createElementBlock(t.Fragment,{key:p.slug},[p.slug==="cwisp"?(t.openBlock(),t.createBlock(i,{key:0,inventory:r.inventory,onToggleItem:d=>e.$emit("toggle-item",d)},null,8,["inventory","onToggleItem"])):(t.openBlock(),t.createElementBlock("div",t.mergeProps({key:1},p.attrs,{onClick:d=>c.click(d,p)}),[p.numbers?(t.openBlock(),t.createElementBlock("div",T,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(p.numbers,(d,H)=>(t.openBlock(),t.createElementBlock("div",{key:H,class:t.normalizeClass(d)},null,2))),128))])):t.createCommentVNode("",!0)],16,I))],64))),128))]))),128))],2)}const _=k(S,[["render",z]]),n={item:e=>({class:e}),group:(e,s)=>[`pause-inventory__group -group-${e}`,s],number:e=>n.item(`smi-number -number-${e}`),numbers:(e,s)=>e.toString().padStart(s,0).split("").map(n.number)};n.separator=n.item("flex-grow");const y=e=>Array(e||0).fill().map((s,r)=>r),f=(e,s)=>({name:"energy-tanks",children:y(e).map(()=>n.item("smi -ietank")),class:n.group("energy-tanks",s)}),w=e=>({name:e,class:n.group(e),children:[n.item("smi -"+e)]}),O={beams:["charge","ice","wave","spazer","plasma"].map(e=>e+"-beam"),suits:["varia-suit","gravity-suit"],misc:["morph-ball","bomb","spring-ball","screw-attack"],boots:["hi-jump-boots","space-jump","speed-booster"]},L=["missile","super-missile","power-bomb","grappling-beam","x-ray"],A={props:{inventory:Object,controlled:Boolean,world:String},emits:["add-item","toggle-item"],computed:{wrapper_class(){return["pause-inventory smi-pause-screen",this.controlled&&"-controlled",this.inventory["super-missile"]>99&&"-high-super-missile",this.inventory["power-bomb"]>99&&"-high-power-bomb"]},groups(){const e=[...this.energy_tanks,this.hud_items,this.reserve_tanks,this.energy_text,...this.pack_numbers,...this.item_groups,...this.pack_controls];return this.inventory["reserve-tank"]&&(e.push(w("auto")),e.push(w("reserve_text"))),e},hud_items(){return{name:"hud-items",class:n.group("hud-items"),children:L.map(e=>({class:["smi -i"+e,this.inventory[e]||"-inactive"],onclick:()=>this.$emit("toggle-item",e)}))}},pack_numbers(){const e=l[this.world]||l.default;return["missile","super-missile","power-bomb"].map(s=>{var o;const r=this.inventory[s]*(((o=e._packs)==null?void 0:o[s])||1);return{name:s,class:n.group(s),children:n.numbers(r||0,s==="missile"?3:2)}})},pack_controls(){return["missile","super-missile","power-bomb","energy-tank","reserve-tank"].map(s=>({name:`${s} controls`,class:n.group(s+"-controls"),children:[{class:"_plus",onclick:()=>this.$emit("add-item",s,1)},{class:"_minus",onclick:()=>this.$emit("add-item",s,-1)}]}))},energy_tanks(){const e=this.inventory["energy-tank"];return[f(Math.min(e,7)),f(Math.max(e-7,0),"-top")]},reserve_tanks(){const e=this.inventory["reserve-tank"],r=[...y(Math.floor(e)).map(()=>n.item("smi -ireserve")),n.separator];return e>0&&(100*e).toString().split("").forEach(a=>r.push(n.item(`smi-reserve-number -number-${a}`))),{name:"reserve-tanks",class:n.group("reserve-tanks"),children:r}},energy_text(){return{name:"energy-text",class:n.group("energy-text"),children:[n.item("smi -energy"),n.separator,n.number(9),n.number(9)]}},item_groups(){return Object.entries(O).map(([e,s])=>({name:e,class:n.group(e),children:s.map(r=>({class:[`smi-pause-item -${r}`,this.inventory[r]||"-inactive"],onclick:()=>this.$emit("toggle-item",r)}))}))}}};function F(e,s,r,o,a,c){return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(c.wrapper_class)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.groups,i=>(t.openBlock(),t.createElementBlock("div",{key:i.name,class:t.normalizeClass(i.class)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(i.children,(m,g)=>(t.openBlock(),t.createElementBlock("div",t.mergeProps({key:g},m),null,16))),128))],2))),128))],2)}const N={grid:_,compact:_,pause:k(A,[["render",F]])},V={name:"ItemTracker",props:{inventory:Object,controlled:Boolean,compact:Boolean,format:String,width:Number},emits:["add-item","toggle-item"],computed:{tagName(){return N[this.format]},style(){const{width:e}=this;if(!e)return{};const s=5+2*.2+4*.1;return{"--inventory-px":`${e/256}px`,fontSize:`${e/s}px`}}}};function M(e,s,r,o,a,c){return t.openBlock(),t.createBlock(t.resolveDynamicComponent(c.tagName),{inventory:r.inventory,controlled:r.controlled,compact:r.compact||r.format==="compact",style:t.normalizeStyle(c.style),onAddItem:s[0]||(s[0]=(i,m)=>!r.controlled&&e.$emit("add-item",i,m)),onToggleItem:s[1]||(s[1]=i=>!r.controlled&&e.$emit("toggle-item",i))},null,40,["inventory","controlled","compact","style"])}const B=k(V,[["render",M]]),P=["charge-beam","wave-beam","ice-beam","spazer-beam","plasma-beam"],G={props:{inventory:Object},emits:["toggle-item"],computed:{beams(){return P.map(e=>({id:e,class:[`sm-cwisp__cell -${e}`,this.inventory[e]?"-active":"-inactive"]}))}}},K={class:"sm-cwisp"},q=["onClick"];function D(e,s,r,o,a,c){return t.openBlock(),t.createElementBlock("div",K,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.beams,i=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(i.class),onClick:m=>e.$emit("toggle-item",i.id),key:i.id},null,10,q))),128))])}const Z=k(G,[["render",D]]);return{ItemTracker:B,install(e){e.component("SmItemTracker",B),e.component("SmCwispTracker",Z)}}});
