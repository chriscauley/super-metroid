(function(t,p){typeof exports=="object"&&typeof module<"u"?module.exports=p(require("vue")):typeof define=="function"&&define.amd?define(["vue"],p):(t=typeof globalThis<"u"?globalThis:t||self,t["sm-vue"]=p(t.Vue))})(this,function(t){"use strict";const p={default:{_packs:{missile:5,"super-missile":5,"power-bomb":5}},varia:{},nature:{_packs:{missile:5,"super-missile":3,"power-bomb":2},"x-ray":"beam-burst"},vitality:{_packs:{missile:2,"super-missile":1,"power-bomb":1}},ascent:{"spring-ball":"boost-ball",draygon:"weapons-tank","x-ray":"shinespark"}},k=(e,s)=>{const r=e.__vccOpts||e;for(const[o,l]of s)r[o]=l;return r},v=e=>e.replace(/([a-z])([A-Z])/g,"$1-$2").replace(/[\W_]+/g,"-").toLowerCase(),u=[["energy-tank","reserve-tank","missile","super-missile","power-bomb"],["charge-beam","ice-beam","wave-beam","spazer-beam","plasma-beam"],["morph-ball","varia-suit","spring-ball","hi-jump-boots","space-jump"],["bomb","gravity-suit","ridley","speed-booster","screw-attack"],["grappling-beam","kraid","phantoon","draygon","x-ray"]],b=[["cwisp","morph-ball","bomb","spring-ball"],["hi-jump-boots","speed-booster","space-jump","screw-attack"],["varia-suit","ridley","gravity-suit"],["kraid","phantoon","draygon"]],x=[["cwisp","morph-ball","bomb","spring-ball","varia-suit"],["hi-jump-boots","speed-booster","space-jump","screw-attack","gravity-suit"]],E=u[0],g=(e,s,r=2)=>!e||typeof e!="number"?null:(s?e*s:e).toString().padStart(r,0).split("").map(l=>`smi-number -number-${l}`),C=(e,s)=>["ridley","draygon","phantoon","kraid"].includes(e)?[`sm-g4-head -${e}`,s&&"-inactive"]:[`sm-item -${e}`,!s&&"-has-not"],_={"kill kraid":!0,"kill phantoon":!0,"kill draygon":!0,"kill ridley":!0,kraid:!0,phantoon:!0,draygon:!0,ridley:!0},S=e=>e.map(s=>s.filter(r=>!_[r])),z={props:{inventory:Object,controlled:Boolean,mode:String,rows:Array,world:String,objectives:Object,width:Number,objective_order:Array},emits:["add-item","toggle-item","toggle-objective"],computed:{vanilla_objectives(){return!Object.keys(this.objectives||{}).find(s=>!_[s])},row_slugs(){if(this.rows)return this.rows;let e=u.map(r=>r.slice());const s=p[this.world];return this.mode==="cwisp"?this.vanilla_objectives?e=b.map(r=>r.slice()):Object.keys(this.objectives||{}).length<=6?e=b:e=x.map(r=>r.slice()):this.mode==="compact"&&(e[4].pop(),e[4].shift(),e.shift()),s&&(e=e.map(r=>r.map(o=>s[o]||o))),this.vanilla_objectives||(e=S(e)),e},columns(){return Object.keys(this.objectives||{}).length>15?6:this.row_slugs[0].length},prepped_rows(){var r,o;const e=p[this.world]||p.default,s=this.row_slugs.map(l=>l.map(c=>{var a;const n=this.inventory[c];return{slug:c,numbers:g(n,(a=e._packs)==null?void 0:a[c]),attrs:{class:[C(c,n),n>99&&"-three-digits"],id:`grid-tracker__${c}`}}}));if(!this.vanilla_objectives){const l=Object.keys(this.objectives||{}),{columns:c}=this;this.mode||s[3].push(...s.pop());let n=s.findIndex(a=>a.length<s[0].length);for(n===-1&&(n=s.length);l.length>0;){for(;((r=s[n])==null?void 0:r.length)>=c;)n++;s[n]||s.push([]);const a=l.shift(),d=v(a);let m;(o=this.objective_order)!=null&&o.includes(a)&&(m=this.objective_order.indexOf(a)+1),s[n].push({slug:a,type:"objective",numbers:g(m,1,1),attrs:{class:`smv-objective -${d} -${this.objectives[a]?"in":""}active`,id:`grid-tracker__${d}`}})}}return s},style(){const{width:e}=this;if(!e)return{};const s=this.columns+2*.2+4*.1;return{fontSize:`${e/s}px`}}},methods:{click(e,{slug:s,type:r}={}){if(r==="objective")this.$emit("toggle-objective",s);else if(E.includes(s)){const o=e.shiftKey||e.ctrlKey?-1:1;this.$emit("add-item",s,o)}else this.$emit("toggle-item",s)}}},O=["onClick"];function T(e,s,r,o,l,c){const n=t.resolveComponent("sm-cwisp-tracker");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(`grid-tracker smi-tracker ${r.controlled?"-controlled":""}`),style:t.normalizeStyle(c.style)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.prepped_rows,(a,d)=>(t.openBlock(),t.createElementBlock("div",{key:d,class:"grid-tracker__row"},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(a,m=>(t.openBlock(),t.createElementBlock("div",{key:m.slug,class:"grid-tracker__cell"},[m.slug==="cwisp"?(t.openBlock(),t.createBlock(n,{key:0,inventory:r.inventory,onToggleItem:h=>e.$emit("toggle-item",h)},null,8,["inventory","onToggleItem"])):(t.openBlock(),t.createElementBlock("div",t.mergeProps({key:1},m.attrs,{onClick:h=>c.click(h,m)}),null,16,O)),m.numbers?(t.openBlock(),t.createElementBlock("div",{key:2,class:t.normalizeClass(`grid-tracker__numbers -length-${m.numbers.length}`)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(m.numbers,(h,K)=>(t.openBlock(),t.createElementBlock("div",{key:K,class:t.normalizeClass(h)},null,2))),128))],2)):t.createCommentVNode("",!0)]))),128))]))),128))],6)}const y=k(z,[["render",T]]),i={item:e=>({class:e}),group:(e,s)=>[`pause-inventory__group -group-${e}`,s],number:e=>i.item(`smi-number -number-${e}`),numbers:(e,s)=>e.toString().padStart(s,0).split("").map(i.number)};i.separator=i.item("flex-grow");const w=e=>Array(e||0).fill().map((s,r)=>r),f=(e,s)=>({name:"energy-tanks",children:w(e).map(()=>i.item("smi -ietank")),class:i.group("energy-tanks",s)}),j=e=>({name:e,class:i.group(e),children:[i.item("smi -"+e)]}),L={beams:["charge","ice","wave","spazer","plasma"].map(e=>e+"-beam"),suits:["varia-suit","gravity-suit"],misc:["morph-ball","bomb","spring-ball","screw-attack"],boots:["hi-jump-boots","space-jump","speed-booster"]},A=["missile","super-missile","power-bomb","grappling-beam","x-ray"],F={props:{inventory:Object,controlled:Boolean,world:String,width:Number},emits:["add-item","toggle-item"],computed:{wrapper_class(){return["pause-inventory smi-pause-screen",this.controlled&&"-controlled",this.inventory["super-missile"]>99&&"-high-super-missile",this.inventory["power-bomb"]>99&&"-high-power-bomb"]},groups(){const e=[...this.energy_tanks,this.hud_items,this.reserve_tanks,this.energy_text,...this.pack_numbers,...this.item_groups,...this.pack_controls];return this.inventory["reserve-tank"]&&(e.push(j("auto")),e.push(j("reserve_text"))),e},hud_items(){return{name:"hud-items",class:i.group("hud-items"),children:A.map(e=>({class:["smi -i"+e,this.inventory[e]||"-inactive"],onclick:()=>this.$emit("toggle-item",e)}))}},pack_numbers(){const e=p[this.world]||p.default;return["missile","super-missile","power-bomb"].map(s=>{var o;const r=this.inventory[s]*(((o=e._packs)==null?void 0:o[s])||1);return{name:s,class:i.group(s),children:i.numbers(r||0,s==="missile"?3:2)}})},pack_controls(){return["missile","super-missile","power-bomb","energy-tank","reserve-tank"].map(s=>({name:`${s} controls`,class:i.group(s+"-controls"),children:[{class:"_plus",onclick:()=>this.$emit("add-item",s,1)},{class:"_minus",onclick:()=>this.$emit("add-item",s,-1)}]}))},energy_tanks(){const e=this.inventory["energy-tank"];return[f(Math.min(e,7)),f(Math.max(e-7,0),"-top")]},reserve_tanks(){const e=this.inventory["reserve-tank"],r=[...w(Math.floor(e)).map(()=>i.item("smi -ireserve")),i.separator];return e>0&&(100*e).toString().split("").forEach(l=>r.push(i.item(`smi-reserve-number -number-${l}`))),{name:"reserve-tanks",class:i.group("reserve-tanks"),children:r}},energy_text(){return{name:"energy-text",class:i.group("energy-text"),children:[i.item("smi -energy"),i.separator,i.number(9),i.number(9)]}},item_groups(){return Object.entries(L).map(([e,s])=>({name:e,class:i.group(e),children:s.map(r=>({class:[`smi-pause-item -${r}`,this.inventory[r]||"-inactive"],onclick:()=>this.$emit("toggle-item",r)}))}))},style(){return this.width&&{"--inventory-px":`${this.width/256}px`}}}};function V(e,s,r,o,l,c){return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(c.wrapper_class),style:t.normalizeStyle(c.style)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.groups,n=>(t.openBlock(),t.createElementBlock("div",{key:n.name,class:t.normalizeClass(n.class)},[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(n.children,(a,d)=>(t.openBlock(),t.createElementBlock("div",t.mergeProps({key:d},a),null,16))),128))],2))),128))],6)}const B=k(F,[["render",V]]),I=["charge-beam","wave-beam","ice-beam","spazer-beam","plasma-beam"],N={props:{inventory:Object},emits:["toggle-item"],computed:{beams(){return I.map(e=>({id:e,class:[`sm-cwisp__cell -${e}`,this.inventory[e]?"-active":"-inactive"]}))}}},M={class:"sm-cwisp"},P=["onClick"];function G(e,s,r,o,l,c){return t.openBlock(),t.createElementBlock("div",M,[(t.openBlock(!0),t.createElementBlock(t.Fragment,null,t.renderList(c.beams,n=>(t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(n.class),onClick:a=>e.$emit("toggle-item",n.id),key:n.id},null,10,P))),128))])}const $=k(N,[["render",G]]);return{GridTracker:y,PauseTracker:B,CwispTracker:$,install(e){e.component("SmGridTracker",y),e.component("SmPauseTracker",B),e.component("SmCwispTracker",$)}}});
